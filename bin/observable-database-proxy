#!/usr/bin/env node

require = require("esm")(module);

const argv = require("yargs")
  .usage(`$0 <name> [options]`, "Start database connector", yargs => {
    yargs.positional("name", {
      describe: "Database connector name",
      type: "string"
    });
  })
  .describe(`reset`, `Reset an existing database proxy configuration`)
  .describe(
    `sslcert`,
    `Set the SSL certificate location for an HTTPS database proxy`
  )
  .describe(
    `sslkey`,
    `Set the SSL private key location for an HTTPS database proxy`
  )
  .example(
    `$0 localdb`,
    `Configure or run an HTTP database proxy named "localdb"`
  )
  .example(
    `$0 localssl --sslkey ../ssl/localhost.key --sslcert ../ssl/localhost.crt`,
    `Configure or run an HTTPS database proxy named "localssl"`
  ).argv;

const getConfig = require("../lib/config").default(argv);
const server = require("../lib/server").default(argv);

getConfig().then(server);
